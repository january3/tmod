<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Upset plot — upset • tmod</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Upset plot — upset" />
<meta property="og:description" content="Upset plots help to interpret the results of gene set enrichment." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tmod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.46.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Upset plot</h1>
    
    <div class="hidden name"><code>upset.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Upset plots help to interpret the results of gene set enrichment.</p>
    </div>

    <pre class="usage"><span class='fu'>upset</span>(
  <span class='no'>modules</span>,
  <span class='kw'>mset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>min.size</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>min.overlap</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>max.comb</span> <span class='kw'>=</span> <span class='fl'>4</span>,
  <span class='kw'>min.group</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>value</span> <span class='kw'>=</span> <span class='st'>"number"</span>,
  <span class='kw'>cutoff</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>labels</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>group.stat</span> <span class='kw'>=</span> <span class='st'>"jaccard"</span>,
  <span class='kw'>group.cutoff</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>group</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>pal</span> <span class='kw'>=</span> <span class='fu'>brewer.pal</span>(<span class='fl'>8</span>, <span class='st'>"Dark2"</span>),
  <span class='kw'>lab.cex</span> <span class='kw'>=</span> <span class='fl'>1</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>modules</th>
      <td><p>optional list of modules for which to make the test</p></td>
    </tr>
    <tr>
      <th>mset</th>
      <td><p>Which module set to use. Either a character vector ("LI", "DC" or "all", default: LI) or an object of class tmod (see "Custom module definitions" below)</p></td>
    </tr>
    <tr>
      <th>min.size</th>
      <td><p>minimal number of modules in a comparison to show</p></td>
    </tr>
    <tr>
      <th>min.overlap</th>
      <td><p>smallest overlap (number of elements) between two modules to plot</p></td>
    </tr>
    <tr>
      <th>max.comb</th>
      <td><p>Maximum number of combinations to show (i.e., number of
dots on every vertical segment in the upset plot)</p></td>
    </tr>
    <tr>
      <th>min.group</th>
      <td><p>Minimum number of modules in a group. Group with a
smaller number of members will be ignored. Change this value to 
1 to see also modules which could not be grouped.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>what to show on the plot: "number" (number of common
elements; default), "soerensen" (Sørensen–Dice coefficient), 
"overlap" (Szymkiewicz–Simpson coefficient) or "jaccard" (Jaccard index)</p></td>
    </tr>
    <tr>
      <th>cutoff</th>
      <td><p>Combinations with the `value` below cutoff will not be shown.</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>Labels for the modules. Character vector with the same
length as `modules`</p></td>
    </tr>
    <tr>
      <th>group.stat</th>
      <td><p>Statistics for finding groups 
(can be "number", "overlap", "soerensen" or "jaccard"; see function modOverlaps)</p></td>
    </tr>
    <tr>
      <th>group.cutoff</th>
      <td><p>cutoff for group statistics</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>Should the modules be grouped by the overlap?</p></td>
    </tr>
    <tr>
      <th>pal</th>
      <td><p>Color palette to show the groups.</p></td>
    </tr>
    <tr>
      <th>lab.cex</th>
      <td><p>Initial cex (font size) for labels</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>upset returns invisibly the identified module groups: a list of
        character vectors.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The plot consists of three parts. The main part shows the overlaps
between the different modules (module can be a gene set, for example).
Each row corresponds to one module. Each column corresponds to an
intersection of one or more gene sets. Dots show which gene sets are in
that combination. Which combinations are shown depends on the parameters
`min.overlap` (which is the cutoff for the similarity measure specified by
the `value` parameter), the parameter `min.group` which specifies the
minimum number of modules in a group and the parameter `max.comb` which
specifies the maximum number of combinations tested (too many combinations
are messing the plot).</p>
<p>Above the intersections, you see a plot showing a similarity measure of
the intersected gene sets. By default it is the number of module members
(genes in case of a gene set), but several
other measures (e.g. the Jaccard index) are also implemented.</p>
<p>To the left are the module descriptions (parameter `label`; if label is
empty, the labels are taken from the mset object provided or, if that is
NULL, from the default tmod module set). The function attempts to scale
the text in such a way that all labels are visible.</p>
<p>By default, upset attempts to group the modules. This is done by
defining a similarity measure (by default the Jaccard index, parameter
`group.stat`) and a cutoff threshold (parameter `group.cutoff`).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>modGroups, modOverlaps</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>Egambia</span>)
<span class='no'>design</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/cbind.html'>cbind</a></span>(<span class='kw'>Intercept</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>30</span>), <span class='kw'>TB</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>), <span class='kw'>each</span><span class='kw'>=</span> <span class='fl'>15</span>))
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>limma</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/ebayes.html'>eBayes</a></span>( <span class='fu'><a href='https://rdrr.io/pkg/limma/man/lmFit.html'>lmFit</a></span>(<span class='no'>Egambia</span>[,-<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='fl'>3</span>)], <span class='no'>design</span>))
<span class='no'>tt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span>(<span class='no'>fit</span>, <span class='kw'>coef</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>number</span><span class='kw'>=</span><span class='fl'>Inf</span>, <span class='kw'>genelist</span><span class='kw'>=</span><span class='no'>Egambia</span>[,<span class='fl'>1</span>:<span class='fl'>3</span>] )
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='tmodUtest.html'>tmodCERNOtest</a></span>(<span class='no'>tt</span>$<span class='no'>GENE_SYMBOL</span>)

<span class='fu'>upset</span>(<span class='no'>res</span>$<span class='no'>ID</span>, <span class='kw'>group.cutoff</span><span class='kw'>=</span><span class='fl'>.1</span>, <span class='kw'>value</span><span class='kw'>=</span><span class='st'>"jaccard"</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by January Weiner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


