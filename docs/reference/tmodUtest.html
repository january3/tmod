<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform a statistical test of module expression — tmodUtest • tmod</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform a statistical test of module expression — tmodUtest" />
<meta property="og:description" content="Perform a statistical test of module expression" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tmod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.46.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform a statistical test of module expression</h1>
    
    <div class="hidden name"><code>tmodUtest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform a statistical test of module expression</p>
    </div>

    <pre class="usage"><span class='fu'>tmodUtest</span>(
  <span class='no'>l</span>,
  <span class='kw'>modules</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>qval</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>order.by</span> <span class='kw'>=</span> <span class='st'>"pval"</span>,
  <span class='kw'>filter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>mset</span> <span class='kw'>=</span> <span class='st'>"LI"</span>,
  <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"Title"</span>,
  <span class='kw'>useR</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>nodups</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)

<span class='fu'>tmodGeneSetTest</span>(
  <span class='no'>l</span>,
  <span class='no'>x</span>,
  <span class='kw'>modules</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>qval</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>order.by</span> <span class='kw'>=</span> <span class='st'>"pval"</span>,
  <span class='kw'>filter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>mset</span> <span class='kw'>=</span> <span class='st'>"LI"</span>,
  <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"Title"</span>,
  <span class='kw'>Nsim</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>nodups</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)

<span class='fu'>tmodCERNOtest</span>(
  <span class='no'>l</span>,
  <span class='kw'>modules</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>qval</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>order.by</span> <span class='kw'>=</span> <span class='st'>"pval"</span>,
  <span class='kw'>filter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>mset</span> <span class='kw'>=</span> <span class='st'>"LI"</span>,
  <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"Title"</span>,
  <span class='kw'>nodups</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)

<span class='fu'>tmodPLAGEtest</span>(
  <span class='no'>l</span>,
  <span class='no'>x</span>,
  <span class='no'>group</span>,
  <span class='kw'>modules</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>qval</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>order.by</span> <span class='kw'>=</span> <span class='st'>"pval"</span>,
  <span class='kw'>mset</span> <span class='kw'>=</span> <span class='st'>"LI"</span>,
  <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"Title"</span>,
  <span class='kw'>nodups</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)

<span class='fu'>tmodZtest</span>(
  <span class='no'>l</span>,
  <span class='kw'>modules</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>qval</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>order.by</span> <span class='kw'>=</span> <span class='st'>"pval"</span>,
  <span class='kw'>filter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>mset</span> <span class='kw'>=</span> <span class='st'>"LI"</span>,
  <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"Title"</span>
)

<span class='fu'>tmodWZtest</span>(
  <span class='no'>l</span>,
  <span class='kw'>modules</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>qval</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>order.by</span> <span class='kw'>=</span> <span class='st'>"pval"</span>,
  <span class='kw'>filter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>mset</span> <span class='kw'>=</span> <span class='st'>"LI"</span>,
  <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"Title"</span>
)

<span class='fu'>tmodHGtest</span>(
  <span class='no'>fg</span>,
  <span class='no'>bg</span>,
  <span class='kw'>modules</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>qval</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>order.by</span> <span class='kw'>=</span> <span class='st'>"pval"</span>,
  <span class='kw'>filter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>mset</span> <span class='kw'>=</span> <span class='st'>"LI"</span>,
  <span class='kw'>cols</span> <span class='kw'>=</span> <span class='st'>"Title"</span>,
  <span class='kw'>nodups</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>l</th>
      <td><p>sorted list of HGNC gene identifiers</p></td>
    </tr>
    <tr>
      <th>modules</th>
      <td><p>optional list of modules for which to make the test</p></td>
    </tr>
    <tr>
      <th>qval</th>
      <td><p>Threshold FDR value to report</p></td>
    </tr>
    <tr>
      <th>order.by</th>
      <td><p>Order by P value ("pval") or none ("none")</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>Remove gene names which have no module assignments</p></td>
    </tr>
    <tr>
      <th>mset</th>
      <td><p>Which module set to use. Either a character vector ("LI", "DC" or "all", default: LI) or an object of class tmod (see "Custom module definitions" below)</p></td>
    </tr>
    <tr>
      <th>cols</th>
      <td><p>Which columns from the MODULES data frame should be included in resulsts</p></td>
    </tr>
    <tr>
      <th>useR</th>
      <td><p>use the R <code>wilcox.test</code> function; slow, but with exact p-values for small samples</p></td>
    </tr>
    <tr>
      <th>nodups</th>
      <td><p>Remove duplicate gene names in l and corresponding
rows from ranks</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Expression matrix for the tmodPLAGEtest; a vector for tmodGeneSetTest</p></td>
    </tr>
    <tr>
      <th>Nsim</th>
      <td><p>for tmodGeneSetTest, number of replicates for the randomization test</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>group assignments for the tmodPLAGEtest</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>for tmodWZtest</p></td>
    </tr>
    <tr>
      <th>fg</th>
      <td><p>foreground gene set for the HG test</p></td>
    </tr>
    <tr>
      <th>bg</th>
      <td><p>background gene set for the HG test</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The statistical tests return a data frame with module names, additional statistic (e.g.
enrichment or AUC, depending on the test), P value and FDR q-value (P value corrected for multiple
testing using the p.adjust function and Benjamini-Hochberg correction.
The data frame has class 'colorDF' (see package colorDF for details),
but except for printing using colors on the terminal behaves just like an
ordinary data.frame. To strip the coloring, use [colorDF::uncolor()].</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Performs a test on either on an ordered list of genes (tmodUtest,
tmodCERNOtest, tmodZtest) or on two groups of genes (tmodHGtest).
tmodUtest is a U test on ranks of genes that are contained in a module.</p>
<p>tmodCERNOtest is also a nonparametric test working on gene ranks, but it
originates from Fisher's combined probability test. This test weights
genes with lower ranks more, the resulting p-values better correspond to
the observed effect size. In effect, modules with small effect but many
genes get higher p-values than in case of the U-test.</p>
<p>tmodPLAGEtest is based on the PLAGE, "Pathway level analysis of gene
expression" published by Tomfohr, Lu and Kepler (2005), doi 10.1186/1471-2105-6-225.
In essence it is just a t-test run on module eigengenes, but it
performs really well. This approach can be used with any complex linear
model; for this, use the function eigengene(). See users guide for details.</p>
<p>tmodZtest works very much like tmodCERNOtest, but instead of combining
the rank-derived p-values using Fisher's method, it uses the Stouffer
method (known also as the Z-transform test).</p>
<p>tmodGeneSetTest is an implementation of the function geneSetTest from
the limma package (note that tmodUtest is equivalent to the limma's
wilcoxGST function).</p>
<p>For a discussion of the above three methods, read M. C. Whitlock,
"Combining probability from independent tests: the weighted Z-method is
superior to Fisher's approach", J. Evol. Biol. 2005 (doi:
10.1111/j.1420-9101.2005.00917.x) for further details.</p>
<p>tmodHGtest is simply a hypergeometric test.</p>
<p>In tmod, two module sets can be used, "LI" (from Li et al. 2013), or
"DC" (from Chaussabel et al. 2008). Using the parameter "mset", the
module set can be selected, or, if mset is "all", both of sets are used.</p>
    <h2 class="hasAnchor" id="custom-module-definitions"><a class="anchor" href="#custom-module-definitions"></a>Custom module definitions</h2>

    


<p>Custom and arbitrary module, gene set or pathway definitions can be also provided through the mset
option, if the parameter is a list rather than a character vector. The
list parameter to mset must contain the following members: "MODULES",
"MODULES2GENES" and "GENES".</p>
<p>"MODULES" and "GENES" are data frames. It is required that MODULES
contains the following columns: "ID", specifying a unique identifier of a
module, and "Title", containing the description of the module. The
data frame "GENES" must contain the column "ID".</p>
<p>The list MODULES2GENES is a mapping between modules and genes. The names
of the list must correspond to the ID column of the MODULES data frame. The members of the
list are character vectors, and the values of these vectors must correspond
to the ID column of the GENES data frame.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>tmod-package</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>tmod</span>)
<span class='no'>fg</span> <span class='kw'>&lt;-</span> <span class='no'>tmod</span>$<span class='no'>MODULES2GENES</span><span class='kw'>[[</span><span class='st'>"LI.M127"</span>]]
<span class='no'>bg</span> <span class='kw'>&lt;-</span> <span class='no'>tmod</span>$<span class='no'>GENES</span>$<span class='no'>ID</span>
<span class='no'>result</span> <span class='kw'>&lt;-</span> <span class='fu'>tmodHGtest</span>( <span class='no'>fg</span>, <span class='no'>bg</span> )

<span class='co'>## A more sophisticated example</span>
<span class='co'>## Gene set enrichment in TB patients compared to </span>
<span class='co'>## healthy controls (Egambia data set)</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>Egambia</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>limma</span>)
<span class='no'>design</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/cbind.html'>cbind</a></span>(<span class='kw'>Intercept</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>30</span>), <span class='kw'>TB</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>), <span class='kw'>each</span><span class='kw'>=</span> <span class='fl'>15</span>))
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/ebayes.html'>eBayes</a></span>( <span class='fu'><a href='https://rdrr.io/pkg/limma/man/lmFit.html'>lmFit</a></span>(<span class='no'>Egambia</span>[,-<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='fl'>3</span>)], <span class='no'>design</span>))
<span class='no'>tt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span>(<span class='no'>fit</span>, <span class='kw'>coef</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>number</span><span class='kw'>=</span><span class='fl'>Inf</span>, <span class='kw'>genelist</span><span class='kw'>=</span><span class='no'>Egambia</span>[,<span class='fl'>1</span>:<span class='fl'>3</span>] )
<span class='fu'>tmodUtest</span>(<span class='no'>tt</span>$<span class='no'>GENE_SYMBOL</span>)
<span class='fu'>tmodCERNOtest</span>(<span class='no'>tt</span>$<span class='no'>GENE_SYMBOL</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by January Weiner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


