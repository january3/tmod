<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Perform a statistical test of module expression"><title>Perform a statistical test of module expression — tmodUtest • tmod</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform a statistical test of module expression — tmodUtest"><meta property="og:description" content="Perform a statistical test of module expression"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tmod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.50.11</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/tmod.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Perform a statistical test of module expression</h1>
      
      <div class="d-none name"><code>tmodUtest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform a statistical test of module expression</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tmodUtest</span><span class="op">(</span></span>
<span>  <span class="va">l</span>,</span>
<span>  modules <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qval <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  order.by <span class="op">=</span> <span class="st">"pval"</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mset <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Title"</span>,</span>
<span>  useR <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nodups <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmodGeneSetTest</span><span class="op">(</span></span>
<span>  <span class="va">l</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  modules <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qval <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  order.by <span class="op">=</span> <span class="st">"pval"</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mset <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Title"</span>,</span>
<span>  Nsim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  nodups <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmodCERNOtest</span><span class="op">(</span></span>
<span>  <span class="va">l</span>,</span>
<span>  modules <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qval <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  order.by <span class="op">=</span> <span class="st">"pval"</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mset <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Title"</span>,</span>
<span>  nodups <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmodPLAGEtest</span><span class="op">(</span></span>
<span>  <span class="va">l</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  modules <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qval <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  order.by <span class="op">=</span> <span class="st">"pval"</span>,</span>
<span>  mset <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Title"</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nodups <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmodZtest</span><span class="op">(</span></span>
<span>  <span class="va">l</span>,</span>
<span>  modules <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qval <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  order.by <span class="op">=</span> <span class="st">"pval"</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mset <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Title"</span>,</span>
<span>  nodups <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmodHGtest</span><span class="op">(</span></span>
<span>  <span class="va">fg</span>,</span>
<span>  <span class="va">bg</span>,</span>
<span>  modules <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qval <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  order.by <span class="op">=</span> <span class="st">"pval"</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mset <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Title"</span>,</span>
<span>  nodups <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>l</dt>
<dd><p>sorted list of HGNC gene identifiers</p></dd>


<dt>modules</dt>
<dd><p>optional list of modules for which to make the test</p></dd>


<dt>qval</dt>
<dd><p>Threshold FDR value to report</p></dd>


<dt>order.by</dt>
<dd><p>Order by P value ("pval") or none ("none")</p></dd>


<dt>filter</dt>
<dd><p>Remove gene names which have no module assignments</p></dd>


<dt>mset</dt>
<dd><p>Which module set to use. Either a character vector ("LI", "DC" or "all", default: all) or an object of class tmod (see "Custom module definitions" below)</p></dd>


<dt>cols</dt>
<dd><p>Which columns from the MODULES data frame should be included in resulsts</p></dd>


<dt>useR</dt>
<dd><p>use the R <code>wilcox.test</code> function; slow, but with exact p-values for small samples</p></dd>


<dt>nodups</dt>
<dd><p>Remove duplicate gene names in l and corresponding
rows from ranks</p></dd>


<dt>x</dt>
<dd><p>Expression matrix for the tmodPLAGEtest; a vector for tmodGeneSetTest</p></dd>


<dt>Nsim</dt>
<dd><p>for tmodGeneSetTest, number of replicates for the randomization test</p></dd>


<dt>group</dt>
<dd><p>group assignments for the tmodPLAGEtest</p></dd>


<dt>fg</dt>
<dd><p>foreground gene set for the HG test</p></dd>


<dt>bg</dt>
<dd><p>background gene set for the HG test</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The statistical tests return a data frame with module names, additional statistic (e.g.
enrichment or AUC, depending on the test), P value and FDR q-value (P value corrected for multiple
testing using the p.adjust function and Benjamini-Hochberg correction.
The data frame has class 'colorDF' (see package colorDF for details),
but except for printing using colors on the terminal behaves just like an
ordinary data.frame. To strip the coloring, use [colorDF::uncolor()].</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Performs a test on either on an ordered list of genes (tmodUtest,
tmodCERNOtest, tmodZtest) or on two groups of genes (tmodHGtest).
tmodUtest is a U test on ranks of genes that are contained in a module.</p>
<p>tmodCERNOtest is also a nonparametric test working on gene ranks, but it
originates from Fisher's combined probability test. This test weights
genes with lower ranks more, the resulting p-values better correspond to
the observed effect size. In effect, modules with small effect but many
genes get higher p-values than in case of the U-test.</p>
<p>tmodPLAGEtest is based on the PLAGE, "Pathway level analysis of gene
expression" published by Tomfohr, Lu and Kepler (2005), doi 10.1186/1471-2105-6-225.
In essence it is just a t-test run on module eigengenes, but it
performs really well. This approach can be used with any complex linear
model; for this, use the function eigengene(). See users guide for details.</p>
<p>tmodZtest works very much like tmodCERNOtest, but instead of combining
the rank-derived p-values using Fisher's method, it uses the Stouffer
method (known also as the Z-transform test).</p>
<p>tmodGeneSetTest is an implementation of the function geneSetTest from
the limma package (note that tmodUtest is equivalent to the limma's
wilcoxGST function).</p>
<p>For a discussion of the above three methods, read M. C. Whitlock,
"Combining probability from independent tests: the weighted Z-method is
superior to Fisher's approach", J. Evol. Biol. 2005 (doi:
10.1111/j.1420-9101.2005.00917.x) for further details.</p>
<p>tmodHGtest is simply a hypergeometric test.</p>
<p>In tmod, two module sets can be used, "LI" (from Li et al. 2013), or
"DC" (from Chaussabel et al. 2008). Using the parameter "mset", the
module set can be selected, or, if mset is "all", both of sets are used.</p>
    </div>
    <div class="section level2">
    <h2 id="custom-module-definitions">Custom module definitions<a class="anchor" aria-label="anchor" href="#custom-module-definitions"></a></h2>
    


<p>Custom and arbitrary module, gene set or pathway definitions can be also provided through the mset
option, if the parameter is a list rather than a character vector. The
list parameter to mset must contain the following members: "MODULES",
"MODULES2GENES" and "GENES".</p>
<p>"MODULES" and "GENES" are data frames. It is required that MODULES
contains the following columns: "ID", specifying a unique identifier of a
module, and "Title", containing the description of the module. The
data frame "GENES" must contain the column "ID".</p>
<p>The list MODULES2GENES is a mapping between modules and genes. The names
of the list must correspond to the ID column of the MODULES data frame. The members of the
list are character vectors, and the values of these vectors must correspond
to the ID column of the GENES data frame.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>tmod-package</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tmod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fg</span> <span class="op">&lt;-</span> <span class="va">tmod</span><span class="op">$</span><span class="va">MODULES2GENES</span><span class="op">[[</span><span class="st">"LI.M127"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">bg</span> <span class="op">&lt;-</span> <span class="va">tmod</span><span class="op">$</span><span class="va">GENES</span><span class="op">$</span><span class="va">ID</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">tmodHGtest</span><span class="op">(</span> <span class="va">fg</span>, <span class="va">bg</span> <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No genes in bg match any of the genes in the GENES</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No genes in fg match any of the genes in the GENES</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A more sophisticated example</span></span></span>
<span class="r-in"><span><span class="co">## Gene set enrichment in TB patients compared to </span></span></span>
<span class="r-in"><span><span class="co">## healthy controls (Egambia data set)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Egambia</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bioinf.wehi.edu.au/limma" class="external-link">limma</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Intercept<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">30</span><span class="op">)</span>, TB<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, each<span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/ebayes.html" class="external-link">eBayes</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/lmFit.html" class="external-link">lmFit</a></span><span class="op">(</span><span class="va">Egambia</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="va">design</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/toptable.html" class="external-link">topTable</a></span><span class="op">(</span><span class="va">fit</span>, coef<span class="op">=</span><span class="fl">2</span>, number<span class="op">=</span><span class="cn">Inf</span>, genelist<span class="op">=</span><span class="va">Egambia</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">tmodUtest</span><span class="op">(</span><span class="va">tt</span><span class="op">$</span><span class="va">GENE_SYMBOL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">tmodCERNOtest</span><span class="op">(</span><span class="va">tt</span><span class="op">$</span><span class="va">GENE_SYMBOL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by January Weiner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

