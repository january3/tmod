<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Plot a summary of multiple tmod analyses"><title>Plot a summary of multiple tmod analyses — tmodPanelPlot • tmod</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a summary of multiple tmod analyses — tmodPanelPlot"><meta property="og:description" content="Plot a summary of multiple tmod analyses"><meta property="og:image" content="https://january3.github.io/tmod/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tmod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.50.12</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/tmod.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/user_manual/tmod_user_manual.html">tmod: A Tool for the Analysis of Gene Set Enrichments</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot a summary of multiple tmod analyses</h1>
      
      <div class="d-none name"><code>tmodPanelPlot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot a summary of multiple tmod analyses</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tmodPanelPlot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pie <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clust <span class="op">=</span> <span class="st">"qval"</span>,</span>
<span>  select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter.empty.cols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  filter.empty.rows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filter.unknown <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filter.rows.pval <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  filter.rows.auc <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  filter.by.id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col.labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col.labels.style <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>  row.labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row.labels.auto <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  pval.thr <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">2</span>,</span>
<span>  pval.thr.lower <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">6</span>,</span>
<span>  plot.func <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grid <span class="op">=</span> <span class="st">"at"</span>,</span>
<span>  pie.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0000FF"</span>, <span class="st">"#cccccc"</span>, <span class="st">"#FF0000"</span><span class="op">)</span>,</span>
<span>  plot.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  text.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pie.style <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  min.e <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  max.e <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  legend.style <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>either a list, in which each element has been generated with a tmod test function, or the result of the tmodSummary function</p></dd>


<dt>pie</dt>
<dd><p>a list of data frames with information for drawing a pie chart</p></dd>


<dt>clust</dt>
<dd><p>whether, in the resulting data frame, the modules should be
ordered by clustering them with either q-values ("qval") or the effect size
("effect"). If "sort" or NULL, the modules are sorted alphabetically by their ID.
If "keep", then the order of the modules is kept.</p></dd>


<dt>select</dt>
<dd><p>a character vector of module IDs to show. If clust == "keep", then in that particular
order.</p></dd>


<dt>filter.empty.cols</dt>
<dd><p>If TRUE, all elements (columns) with no enrichment below pval.thr in any row will be removed</p></dd>


<dt>filter.empty.rows</dt>
<dd><p>If TRUE, all modules (rows) with no enrichment below pval.thr in any column will be removed</p></dd>


<dt>filter.unknown</dt>
<dd><p>If TRUE, modules with no annotation will be omitted</p></dd>


<dt>filter.rows.pval</dt>
<dd><p>Rows in which no p value is below this threshold will be omitted</p></dd>


<dt>filter.rows.auc</dt>
<dd><p>Rows in which no AUC value is above this threshold will be omitted</p></dd>


<dt>filter.by.id</dt>
<dd><p>if provided, show only modules with IDs in this character vector</p></dd>


<dt>col.labels</dt>
<dd><p>Labels for the columns. If NULL, names of the elements
of the list x will be used.</p></dd>


<dt>col.labels.style</dt>
<dd><p>Style of column names: "top" (default), "bottom", "both", "none"</p></dd>


<dt>row.labels</dt>
<dd><p>Labels for the modules. This must be a named vector, with module IDs as vector names. If NULL, module titles from
the analyses results will be used.</p></dd>


<dt>row.labels.auto</dt>
<dd><p>Automatic generation of row labels from module
data: "both" or "auto" (default, ID and title), "id" (only ID), "title" (only title),
"none" (no row label)</p></dd>


<dt>pval.thr</dt>
<dd><p>Results with p-value above pval.thr will not be shown</p></dd>


<dt>pval.thr.lower</dt>
<dd><p>Results with p-value below pval.thr.lower will look identical on the plot</p></dd>


<dt>plot.func</dt>
<dd><p>Optionally, a function to be used to draw the dots. See "pvalEffectPlot"</p></dd>


<dt>grid</dt>
<dd><p>Style of a light-grey grid to be plotted; can be "none", "at" and "between"</p></dd>


<dt>pie.colors</dt>
<dd><p>character vector of length equal to the cardinality of the third dimension of the pie argument. By default: blue, grey and red.</p></dd>


<dt>plot.cex</dt>
<dd><p>a numerical value giving the amount by which the plot
symbols will be maginfied</p></dd>


<dt>text.cex</dt>
<dd><p>a numerical value giving the amount by which the plot
text will be magnified, or a vector containing three cex values for row labels, column labels and legend, respectively</p></dd>


<dt>pie.style</dt>
<dd><p>Can be "auto" (default), "dot", "symdot", "pie", "boxpie", "rug" (see Details)</p></dd>


<dt>min.e, max.e</dt>
<dd><p>scale limits for the effect size (default: 0.5 and 1.0)</p></dd>


<dt>legend.style</dt>
<dd><p>Style of the legend: "auto" -- automatic; "broad":
pval legend side by side with effect size legend; "tall": effect size
legend above pval legend</p></dd>


<dt>...</dt>
<dd><p>Any further arguments will be passed to the pvalEffectPlot function (for example, grid.color)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a data frame with a line for each module encountered anywhere in
the list x, two columns describing the module (ID and module title), and
two columns(effect size and q value) for each element of list x.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is useful if you run an analysis for several conditions or
time points and would like to summarize the information on a plot.
You can use lapply() to generate a list with tmod results and use
tmodPanelPlot to visualize it.</p>
<p>tmodPanelPlot shows a heatmap-like plot. Each row corresponds to one
module, and columns correspond to the time points or conditions for which
the tmod analyses were run. Each significantly enriched module is shown as
a red dot. Size of the dot corresponds to the effect size (for example, AUC
in the CERNO test), and intensity of the color corresponds to the q-value.</p>
<p>By default, tmodPanelPlot visualizes each the results of a single
statistical test by a red dot, or blue and red dots if the effect sizes are both 
negative and positive. However, it is often interesting to know how
many of the genes in a module are significantly up- or down regulated.
tmodPanelPlot can draw a pie chart based on the optional argument "pie".
The argument must be a list of length equal to the length of x.
Note also that the names of the pie list must be equal to the names of x.
Objects returned by the function tmodDecideTests can be directly used
here. The rownames of either the data frame or the array must be the
module IDs.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>tmodDecideTests, tmodSummary, pvalEffectPlot, simplePie</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Egambia</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">E</span> <span class="op">&lt;-</span> <span class="va">Egambia</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">E</span><span class="op">)</span>, scale.<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate enrichment for first 5 PCs</span></span></span>
<span class="r-in"><span><span class="va">gs</span>   <span class="op">&lt;-</span> <span class="va">Egambia</span><span class="op">$</span><span class="va">GENE_SYMBOL</span></span></span>
<span class="r-in"><span><span class="va">gn.f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tmodUtest.html">tmodCERNOtest</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[</span><span class="va">o</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                qval<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">gn.f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">tmodPanelPlot</span><span class="op">(</span><span class="va">x</span>, text.cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tmodPanelPlot-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by January Weiner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

