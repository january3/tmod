<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>PCA plot annotated with tmod — tmodPCA • tmod</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="PCA plot annotated with tmod — tmodPCA" />
<meta property="og:description" content="Generate a PCA plot on which each dimension is annotated by a tag cloud
based on tmod enrichment test." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tmod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.46.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PCA plot annotated with tmod</h1>
    
    <div class="hidden name"><code>tmodPCA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generate a PCA plot on which each dimension is annotated by a tag cloud
based on tmod enrichment test.</p>
    </div>

    <pre class="usage"><span class='fu'>tmodPCA</span>(
  <span class='no'>pca</span>,
  <span class='kw'>loadings</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>genes</span>,
  <span class='kw'>tmodfunc</span> <span class='kw'>=</span> <span class='st'>"tmodCERNOtest"</span>,
  <span class='kw'>plotfunc</span> <span class='kw'>=</span> <span class='no'>pcaplot</span>,
  <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"simple"</span>,
  <span class='kw'>components</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>),
  <span class='kw'>plot.params</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>filter</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>simplify</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>legend</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>maxn</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pca</th>
      <td><p>Object returned by prcomp or a matrix of PCA coordinates. In the latter case, a
loading matrix must be provided separately.</p></td>
    </tr>
    <tr>
      <th>loadings</th>
      <td><p>A matrix with loadings</p></td>
    </tr>
    <tr>
      <th>genes</th>
      <td><p>A character vector with gene identifiers</p></td>
    </tr>
    <tr>
      <th>tmodfunc</th>
      <td><p>Name of the tmod enrichment test function to use. Either</p></td>
    </tr>
    <tr>
      <th>plotfunc</th>
      <td><p>Function for plotting the PCA plot. See Details</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>Type of the plot to generate; see Details. tmodCERNOtest or tmodUtest (tmodHGtest is not suitable)</p></td>
    </tr>
    <tr>
      <th>components</th>
      <td><p>integer vector of length two: components which components to show on the plot. Must be smaller than the number of columns in pca.</p></td>
    </tr>
    <tr>
      <th>plot.params</th>
      <td><p>A list of parameters to be passed to the plotting function. See
Details</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>Whether "uninteresting" modules (with no annotation)
should be removed from the tag cloud</p></td>
    </tr>
    <tr>
      <th>simplify</th>
      <td><p>Whether the names of the modules should be simplified</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p>whether a legend should be shown</p></td>
    </tr>
    <tr>
      <th>maxn</th>
      <td><p>Maximum number of gene set enrichment terms shown on the plot (if NULL – default – all terms will be shown)</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>if FALSE, no plot will be shown, but the enrichments will be calculated and returned invisibly</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Any further parameters passed to the tmod test function</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing the calculated enrichments as well as the
return value from the plotting function</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>There are three types of plots that can be generated (parameter "mode"):
simple, leftbottom and cross. In the "simple" mode, two enrichments are
run, on on each component, sorted by absolute loadings of the PCA
components.
Both "leftbottom" and "cross" run two enrichment analyses on each component,
one on the loadings sorted from lowest to largest, and one on the loadings
sorted from largetst to lowest. Thus, two tag clouds are displayed per
component. In the "leftbottom" mode, the tag clouds are displayed to the
left and below the PCA plot. In the "cross" mode, the tag clouds are
displayed on each of the four sides of the plot.</p>
<p>By default, the plotting function is pca2d from the pca3d package. Any
additional parametrs for pca2d can be passed on using the plot.params
parameter. You can define your own function instead of pca2d, however, mind
that in any case, there will be two parameters passed to it on the first
two positions: pca and components, named "pca" and "components"
respectively.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>Egambia</span>)
<span class='no'>E</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>Egambia</span>[,-<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='fl'>3</span>)])
<span class='no'>pca</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>E</span>), <span class='kw'>scale.</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"CTRL"</span>, <span class='st'>"TB"</span>), <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>15</span>)
<span class='fu'>tmodPCA</span>(<span class='no'>pca</span>,
  <span class='kw'>genes</span><span class='kw'>=</span><span class='no'>Egambia</span>$<span class='no'>GENE_SYMBOL</span>,
  <span class='kw'>components</span><span class='kw'>=</span><span class='fl'>4</span>:<span class='fl'>3</span>,
  <span class='kw'>plot.params</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>group</span><span class='kw'>=</span><span class='no'>group</span>))</div><div class='img'><img src='tmodPCA-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='tmodPCA-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by January Weiner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


